
function updateAverageCheckData() {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var calculationSheet = ss.getSheetByName('–†–∞—Å—á–µ—Ç—ã'); // –õ–∏—Å—Ç "–†–∞—Å—á–µ—Ç—ã"

  // –ü–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ —è—á–µ–µ–∫ CellselectedMonth –∏ CellSelectedYear –Ω–∞ –ª–∏—Å—Ç–µ "–†–∞—Å—á–µ—Ç—ã"
  var selectedMonth = getValue(calculationSheet, CellselectedMonth);
  var selectedYear = getValue(calculationSheet, CellSelectedYear);
  
  Logger.log('–°—Ä –∑–Ω–∞—á –í—ã–±—Ä–∞–Ω–Ω—ã–π –º–µ—Å—è—Ü: ' + selectedMonth);
  Logger.log('–°—Ä –∑–Ω–∞—á –í—ã–±—Ä–∞–Ω–Ω—ã–π –≥–æ–¥: ' + selectedYear);

  // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –º–µ—Å—è—Ü –≤ —á–∏—Å–ª–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
  var monthNum = getMonthNumber(selectedMonth); // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –º–µ—Å—è—Ü–∞ –≤ –µ–≥–æ —á–∏—Å–ª–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
  var shortYear = selectedYear.toString().slice(-2); // –ü–æ—Å–ª–µ–¥–Ω–∏–µ –¥–≤–µ —Ü–∏—Ñ—Ä—ã –≥–æ–¥–∞

  // –§–æ—Ä–º–∏—Ä—É–µ–º –Ω–∞–∑–≤–∞–Ω–∏—è –ª–∏—Å—Ç–æ–≤
  var monthSheetName = `${selectedMonth.toUpperCase()} ${shortYear}`;
  var personalSalesSheetName = `–õ–∏—á–Ω—ã–µ –ø—Ä–æ–¥–∞–∂–∏ ${monthNum}.${selectedYear}`;
  
  Logger.log('–°—Ä –∑–Ω–∞—á –õ–∏—Å—Ç –º–µ—Å—è—Ü–∞: ' + monthSheetName);
  Logger.log('–°—Ä –∑–Ω–∞—á –õ–∏—Å—Ç –ª–∏—á–Ω—ã—Ö –ø—Ä–æ–¥–∞–∂: ' + personalSalesSheetName);

  var monthSheet = ss.getSheetByName(monthSheetName);
  var personalSalesSheet = ss.getSheetByName(personalSalesSheetName);

  if (!monthSheet || !personalSalesSheet) {
    Logger.log('–°—Ä –∑–Ω–∞—á –û–¥–∏–Ω –∏–∑ –ª–∏—Å—Ç–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω: ' + monthSheetName + ' –∏–ª–∏ ' + personalSalesSheetName);
    return;
  }

  // –ù–∞–Ω–∞: –°—Ä–µ–¥–Ω–∏–π —á–µ–∫ (–ù–∞—Ç–∞–ª—å—è)
  var planValueNana = getValue(monthSheet, CellAverageCheckNana); // F28 –ø–ª–∞–Ω–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ª–∏—Å—Ç –ú–ï–°–Ø–¶ –ì–ì
  var nanaCell = findCellByValue(personalSalesSheet, '–ù–∞—Ç–∞–ª—å—è —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫');
  var factValueNana = nanaCell ? personalSalesSheet.getRange(nanaCell.getRow(), 33).getValue() : 0; // AG = 33-–π —Å—Ç–æ–ª–±–µ—Ü
  Logger.log('–ù–∞–Ω–∞: –ü–ª–∞–Ω = ' + planValueNana + ', –§–∞–∫—Ç = ' + factValueNana);

  setValue(calculationSheet, 'I7', planValueNana);
  setValue(calculationSheet, 'J7', Math.round(factValueNana));
  Logger.log('–ó–∞–ø–∏—Å—ã–≤–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ù–∞—Ç–∞–ª—å—è: ' + factValueNana);
  setValue(monthSheet, 'G28', Math.round(factValueNana));
  
  // –°–∞—à–∞: –°—Ä–µ–¥–Ω–∏–π —á–µ–∫
  var planValueSasha = getValue(monthSheet, CellAverageCheckSasha); // F15
  var sashaCell = findCellByValue(personalSalesSheet, '–°–∞—à–∞ —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫');
  var factValueSasha = sashaCell ? personalSalesSheet.getRange(sashaCell.getRow(), 33).getValue() : 0; // AG = 33-–π —Å—Ç–æ–ª–±–µ—Ü
  Logger.log('–°–∞—à–∞: –ü–ª–∞–Ω = ' + planValueSasha + ', –§–∞–∫—Ç = ' + factValueSasha);

  setValue(calculationSheet, 'I8', planValueSasha);
  setValue(calculationSheet, 'J8', Math.round(factValueSasha));
  setValue(monthSheet, 'G15', Math.round(factValueSasha));

  Logger.log('–î–∞–Ω–Ω—ã–µ –¥–ª—è —Å—Ä–µ–¥–Ω–µ–≥–æ —á–µ–∫–∞ –≤—Å—Ç–∞–≤–ª–µ–Ω—ã –≤ –ª–∏—Å—Ç "–†–∞—Å—á–µ—Ç—ã".');
}




// –ü–æ–ª—É—á–µ–Ω–∏–µ –õ–∏—á–Ω—ã—Ö –ø—Ä–æ–¥–∞–∂ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ –∑–∞ –ø–µ—Ä–∏–æ–¥
function updateManagerRevenueData() {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var calculationSheet = ss.getSheetByName('–†–∞—Å—á–µ—Ç—ã'); // –õ–∏—Å—Ç "–†–∞—Å—á–µ—Ç—ã"

  // –ü–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ —è—á–µ–µ–∫ CellselectedMonth –∏ CellSelectedYear –Ω–∞ –ª–∏—Å—Ç–µ "–†–∞—Å—á–µ—Ç—ã"
  var selectedMonth = getValue(calculationSheet, CellselectedMonth);
  var selectedYear = getValue(calculationSheet, CellSelectedYear);
  
  Logger.log('–í—ã–±—Ä–∞–Ω–Ω—ã–π –º–µ—Å—è—Ü: ' + selectedMonth);
  Logger.log('–í—ã–±—Ä–∞–Ω–Ω—ã–π –≥–æ–¥: ' + selectedYear);

  // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –º–µ—Å—è—Ü –≤ —á–∏—Å–ª–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
  var monthNum = getMonthNumber(selectedMonth); // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –º–µ—Å—è—Ü–∞ –≤ –µ–≥–æ —á–∏—Å–ª–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
  var shortYear = selectedYear.toString().slice(-2); // –ü–æ—Å–ª–µ–¥–Ω–∏–µ –¥–≤–µ —Ü–∏—Ñ—Ä—ã –≥–æ–¥–∞

  // –§–æ—Ä–º–∏—Ä—É–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –ª–∏—Å—Ç–∞ –ª–∏—á–Ω—ã—Ö –ø—Ä–æ–¥–∞–∂
  var monthSheetName = `${selectedMonth.toUpperCase()} ${shortYear}`;
  var personalSalesSheetName = `–õ–∏—á–Ω—ã–µ –ø—Ä–æ–¥–∞–∂–∏ ${monthNum}.${selectedYear}`;
  Logger.log('–õ–∏—Å—Ç –ª–∏—á–Ω—ã—Ö –ø—Ä–æ–¥–∞–∂: ' + personalSalesSheetName);

  var monthSheet = ss.getSheetByName(monthSheetName);
  var personalSalesSheet = ss.getSheetByName(personalSalesSheetName);

  if (!personalSalesSheet) {
    Logger.log('–õ–∏—Å—Ç –ª–∏—á–Ω—ã—Ö –ø—Ä–æ–¥–∞–∂ –Ω–µ –Ω–∞–π–¥–µ–Ω: ' + personalSalesSheetName);
    return;
  }

  // –ù–∞–Ω–∞: –í—ã—Ä—É—á–∫–∞ –ù–∞–Ω–∞
  var nanaCell = findCellByValue(personalSalesSheet, '–ù–∞—Ç–∞–ª—å—è –∏—Ç–æ–≥–æ');
  var revenueNana = nanaCell ? personalSalesSheet.getRange(nanaCell.getRow(), 34).getValue() : 0; // AH = 34-–π —Å—Ç–æ–ª–±–µ—Ü
  var planRevenueNana = getValue(monthSheet, 'F29');
  Logger.log('–ù–∞–Ω–∞: –í—ã—Ä—É—á–∫–∞ –ù–∞–Ω–∞ = ' + revenueNana);
  Logger.log('–ü–ª–∞–Ω –≤—ã—Ä—É—á–∫–∏ –ù–∞–Ω–∞: ' + planRevenueNana);

  setValue(calculationSheet, 'G7', planRevenueNana);
  setValue(calculationSheet, 'H7', revenueNana);
  setValue(monthSheet, 'G29', revenueNana);

  // –°–∞—à–∞: –í—ã—Ä—É—á–∫–∞ –°–∞—à–∞
  var sashaCell = findCellByValue(personalSalesSheet, '–°–∞—à–∞ –∏—Ç–æ–≥–æ');
  var revenueSasha = sashaCell ? personalSalesSheet.getRange(sashaCell.getRow(), 34).getValue() : 0; // AH = 34-–π —Å—Ç–æ–ª–±–µ—Ü
  var planRevenueSasha = getValue(monthSheet, 'F16');
  Logger.log('–°–∞—à–∞: –í—ã—Ä—É—á–∫–∞ –°–∞—à–∞ = ' + revenueSasha);
  Logger.log('–ü–ª–∞–Ω –≤—ã—Ä—É—á–∫–∏ –°–∞—à–∞: ' + planRevenueSasha);

  setValue(calculationSheet, 'G8', planRevenueSasha);
  setValue(calculationSheet, 'H8', revenueSasha);
  setValue(monthSheet, 'G16', revenueSasha);

  Logger.log('–í—ã—Ä—É—á–∫–∞ –ù–∞–Ω–∞ ' + revenueNana);
  Logger.log('–í—ã—Ä—É—á–∫–∞ –°–∞—à–∞ ' + revenueSasha);

  Logger.log('–î–∞–Ω–Ω—ã–µ –≤—ã—Ä—É—á–∫–∏ –ø–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞–º –≤—Å—Ç–∞–≤–ª–µ–Ω—ã –≤ –ª–∏—Å—Ç "–†–∞—Å—á–µ—Ç—ã".');
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø–∏—Å–∏ –ø—Ä–æ–¥–ª–µ–Ω–∏–π –ø–æ —á–∞—Å–∞–º
function updateSalesSheetHoursExtension() {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var calculationSheet = ss.getSheetByName('–†–∞—Å—á–µ—Ç—ã');
  
  // –ü–æ–ª—É—á–∞–µ–º –º–µ—Å—è—Ü –∏ –≥–æ–¥
  var selectedMonth = String(getValue(calculationSheet, CellselectedMonth)).trim();
  var selectedYear = String(getValue(calculationSheet, CellSelectedYear)).trim();
  
  // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –º–µ—Å—è—Ü–∞ –≤ —á–∏—Å–ª–æ–≤–æ–π —Ñ–æ—Ä–º–∞—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–Ø–Ω–≤–∞—Ä—å" ‚Üí "01")
  var monthNumber = getMonthNumber(selectedMonth);

  // –§–æ—Ä–º–∏—Ä—É–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –ª–∏—Å—Ç–∞ "–õ–∏—á–Ω—ã–µ –ø—Ä–æ–¥–∞–∂–∏ –ú–ú.–ì–ì–ì–ì"
  var salesSheetName = '–õ–∏—á–Ω—ã–µ –ø—Ä–æ–¥–∞–∂–∏ ' + monthNumber + '.' + selectedYear;
  var salesSheet = ss.getSheetByName(salesSheetName);
  
  if (!salesSheet) {
    Logger.log('‚ùå –õ–∏—Å—Ç "' + salesSheetName + '" –Ω–µ –Ω–∞–π–¥–µ–Ω!');
    return;
  }
  
  Logger.log('üìå –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ –ª–∏—Å—Ç–∞: ' + salesSheetName);

  // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤
  var nanaPersonalCell = findCellByValue(salesSheet, '–ù–∞—Ç–∞–ª—å—è –ø—Ä–æ–¥–ª–µ–Ω–∏–µ –ø–æ —á–∞—Å–∞–º');
  var nanaPersonalHours = nanaPersonalCell ? parseFloat(salesSheet.getRange(nanaPersonalCell.getRow(), 33).getValue()) || 0 : 0; // AG = 33-–π —Å—Ç–æ–ª–±–µ—Ü
  var nanaWebsiteCell = findCellByValue(salesSheet, '–ü—Ä–æ–¥–ª–µ–Ω–∏–µ –ø–æ —á–∞—Å–∞–º –ù–∞—Ç–∞–ª—å—è');
  var nanaWebsiteHours = nanaWebsiteCell ? parseFloat(salesSheet.getRange(nanaWebsiteCell.getRow(), 33).getValue()) || 0 : 0; // AG = 33-–π —Å—Ç–æ–ª–±–µ—Ü
  var nanaHours = nanaPersonalHours + nanaWebsiteHours;

  var sashaPersonalCell = findCellByValue(salesSheet, '–°–∞—à–∞ –ø—Ä–æ–¥–ª–µ–Ω–∏–µ –ø–æ —á–∞—Å–∞–º');
  var sashaPersonalHours = sashaPersonalCell ? parseFloat(salesSheet.getRange(sashaPersonalCell.getRow(), 33).getValue()) || 0 : 0; // AG = 33-–π —Å—Ç–æ–ª–±–µ—Ü
  var sashaWebsiteCell = findCellByValue(salesSheet, '–ü—Ä–æ–¥–ª–µ–Ω–∏–µ –ø–æ —á–∞—Å–∞–º –°–∞—à–∞');
  var sashaWebsiteHours = sashaWebsiteCell ? parseFloat(salesSheet.getRange(sashaWebsiteCell.getRow(), 33).getValue()) || 0 : 0; // AG = 33-–π —Å—Ç–æ–ª–±–µ—Ü
  var sashaHours = sashaPersonalHours + sashaWebsiteHours;

  Logger.log('‚úÖ –ü—Ä–æ–¥–ª–µ–Ω–∏–µ –ø–æ —á–∞—Å–∞–º (–ù–∞–Ω–∞): ' + nanaHours);
  Logger.log('‚úÖ –ü—Ä–æ–¥–ª–µ–Ω–∏–µ –ø–æ —á–∞—Å–∞–º (–°–∞—à–∞): ' + sashaHours);

  // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ª–∏—Å—Ç "–ú–ï–°–Ø–¶ –ì–ì" (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–Ø–ù–í–ê–†–¨ 25")
  var monthUpperCase = selectedMonth.toUpperCase();
  var targetSheetName = monthUpperCase + ' ' + selectedYear.toString().slice(-2);
  var monthSheet = ss.getSheetByName(targetSheetName);
  
  if (!monthSheet) {
    Logger.log('‚ùå –õ–∏—Å—Ç –º–µ—Å—è—Ü–∞ "' + targetSheetName + '" –Ω–µ –Ω–∞–π–¥–µ–Ω!');
    return;
  }

  Logger.log('üìå –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –ª–∏—Å—Ç: ' + targetSheetName);

  // –ó–∞–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö –≤ —è—á–µ–π–∫–∏
  monthSheet.getRange('G32').setValue(nanaHours);
  monthSheet.getRange('G18').setValue(sashaHours);

  Logger.log('‚úÖ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–ø–∏—Å–∞–Ω—ã:');
  Logger.log('   - –ù–∞–Ω–∞: ' + nanaHours + ' —á–∞—Å–æ–≤ –≤ G32');
  Logger.log('   - –°–∞—à–∞: ' + sashaHours + ' —á–∞—Å–æ–≤ –≤ G18');
}


// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø–∏—Å–∏ –ø–æ –æ—Ç—á–µ—Ç–Ω—ã–º –¥–æ–∫—É–º–µ–Ω—Ç–∞–º
function updateManagerReportData() {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var calculationSheet = ss.getSheetByName('–†–∞—Å—á–µ—Ç—ã');

  Logger.log('--- –ù–ê–ß–ê–õ–û –û–ë–ù–û–í–õ–ï–ù–ò–Ø –î–ê–ù–ù–´–• –ú–ï–ù–ï–î–ñ–ï–†–û–í ---');

  if (!calculationSheet) {
    Logger.log('–û—à–∏–±–∫–∞: –õ–∏—Å—Ç "–†–∞—Å—á–µ—Ç—ã" –Ω–µ –Ω–∞–π–¥–µ–Ω.');
    return;
  }

  // –ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Å—è—Ü–∞ –∏ –≥–æ–¥–∞
  var selectedMonth = String(getValue(calculationSheet, CellselectedMonth)).trim();
  var selectedYear = String(getValue(calculationSheet, CellSelectedYear)).trim();
  
  // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –º–µ—Å—è—Ü–∞ –≤ —á–∏—Å–ª–æ–≤–æ–π —Ñ–æ—Ä–º–∞—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–Ø–Ω–≤–∞—Ä—å" ‚Üí "01")
  var monthNumber = getMonthNumber(selectedMonth);

  // –§–æ—Ä–º–∏—Ä—É–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –ª–∏—Å—Ç–∞ "–õ–∏—á–Ω—ã–µ –ø—Ä–æ–¥–∞–∂–∏ –ú–ú.–ì–ì–ì–ì"
  var salesSheetName = '–õ–∏—á–Ω—ã–µ –ø—Ä–æ–¥–∞–∂–∏ ' + monthNumber + '.' + selectedYear;
  var salesSheet = ss.getSheetByName(salesSheetName);

  if (!salesSheet) {
    Logger.log('‚ùå –õ–∏—Å—Ç "' + salesSheetName + '" –Ω–µ –Ω–∞–π–¥–µ–Ω!');
    return;
  }
  
  Logger.log('üìå –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ –ª–∏—Å—Ç–∞: ' + salesSheetName);

  // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤
  var nanaCell = findCellByValue(salesSheet, '–ù–∞—Ç–∞–ª—å—è –æ—Ç—á–µ—Ç–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã');
  var nanaData;
  if (nanaCell) {
    var nanaRow = nanaCell.getRow();
    var nanaCellAddress = nanaCell.getA1Notation();
    var nanaRawValue = salesSheet.getRange(nanaRow, 33).getValue(); // AG = 33-–π —Å—Ç–æ–ª–±–µ—Ü
    nanaData = parseFloat(nanaRawValue) || 0;
    Logger.log('üìå –ù–∞—Ç–∞–ª—å—è –æ—Ç—á–µ—Ç–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã: –Ω–∞–π–¥–µ–Ω–∞ —è—á–µ–π–∫–∞ %s (—Å—Ç—Ä–æ–∫–∞ %s)', nanaCellAddress, nanaRow);
    Logger.log('   - –ó–Ω–∞—á–µ–Ω–∏–µ –≤ AG (—Å—ã—Ä–æ–µ): %s', nanaRawValue);
    Logger.log('   - –ó–Ω–∞—á–µ–Ω–∏–µ –≤ AG (–ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–Ω–æ–µ): %s', nanaData);
  } else {
    nanaData = 0;
    Logger.log('‚ùå –ù–∞—Ç–∞–ª—å—è –æ—Ç—á–µ—Ç–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã: —è—á–µ–π–∫–∞ —Å —Ç–µ–∫—Å—Ç–æ–º –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
  }

  var sashaCell = findCellByValue(salesSheet, '–°–∞—à–∞ –æ—Ç—á–µ—Ç–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã');
  var sashaData;
  if (sashaCell) {
    var sashaRow = sashaCell.getRow();
    var sashaCellAddress = sashaCell.getA1Notation();
    var sashaRawValue = salesSheet.getRange(sashaRow, 33).getValue(); // AG = 33-–π —Å—Ç–æ–ª–±–µ—Ü
    sashaData = parseFloat(sashaRawValue) || 0;
    Logger.log('üìå –°–∞—à–∞ –æ—Ç—á–µ—Ç–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã: –Ω–∞–π–¥–µ–Ω–∞ —è—á–µ–π–∫–∞ %s (—Å—Ç—Ä–æ–∫–∞ %s)', sashaCellAddress, sashaRow);
    Logger.log('   - –ó–Ω–∞—á–µ–Ω–∏–µ –≤ AG (—Å—ã—Ä–æ–µ): %s', sashaRawValue);
    Logger.log('   - –ó–Ω–∞—á–µ–Ω–∏–µ –≤ AG (–ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–Ω–æ–µ): %s', sashaData);
  } else {
    sashaData = 0;
    Logger.log('‚ùå –°–∞—à–∞ –æ—Ç—á–µ—Ç–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã: —è—á–µ–π–∫–∞ —Å —Ç–µ–∫—Å—Ç–æ–º –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
  }

  Logger.log('‚úÖ –î–∞–Ω–Ω—ã–µ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ (–ù–∞–Ω–∞): ' + nanaData);
  Logger.log('‚úÖ –î–∞–Ω–Ω—ã–µ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ (–°–∞—à–∞): ' + sashaData);

  // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ª–∏—Å—Ç "–ú–ï–°–Ø–¶ –ì–ì" (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–Ø–ù–í–ê–†–¨ 25")
  var monthUpperCase = selectedMonth.toUpperCase();
  var targetSheetName = monthUpperCase + ' ' + selectedYear.toString().slice(-2);
  var monthSheet = ss.getSheetByName(targetSheetName);

  if (!monthSheet) {
    Logger.log('‚ùå –õ–∏—Å—Ç –º–µ—Å—è—Ü–∞ "' + targetSheetName + '" –Ω–µ –Ω–∞–π–¥–µ–Ω!');
    return;
  }

  Logger.log('üìå –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –ª–∏—Å—Ç: ' + targetSheetName);

  // –ó–∞–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö –≤ —è—á–µ–π–∫–∏
  setValue(monthSheet, 'G30', nanaData);
  setValue(monthSheet, 'G17', sashaData);

  Logger.log('‚úÖ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–ø–∏—Å–∞–Ω—ã:');
  Logger.log('   - –ù–∞–Ω–∞: ' + nanaData + ' -> G30');
  Logger.log('   - –°–∞—à–∞: ' + sashaData + ' -> G17');
}

// –§—É–Ω–∫—Ü–∏—è findCellByValue (–¥–ª—è –ø–æ–ª–Ω–æ—Ç—ã, –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è, —á—Ç–æ –æ–Ω–∞ —É–∂–µ –µ—Å—Ç—å –≤ –≤–∞—à–∏—Ö —Ñ–∞–π–ª–∞—Ö)
function findCellByValue(sheet, value) {
  var data = sheet.getDataRange().getValues();
  for (var i = 0; i < data.length; i++) {
    for (var j = 0; j < data[i].length; j++) {
      if (data[i][j] === value) {
        return sheet.getRange(i + 1, j + 1);
      }
    }
  }
  return null;
}



// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø–∏—Å–∏ –∫–æ–º–∏—Å—Å–∏–π –∫–æ–ª–ª–µ–≥
function updateSalesSheetCommissions() {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var calculationSheet = ss.getSheetByName('–†–∞—Å—á–µ—Ç—ã');
  
  Logger.log('--- –ù–ê–ß–ê–õ–û –û–ë–ù–û–í–õ–ï–ù–ò–Ø –ö–û–ú–ò–°–°–ò–ô –ö–û–õ–õ–ï–ì ---');

  if (!calculationSheet) {
    Logger.log('–û—à–∏–±–∫–∞: –õ–∏—Å—Ç "–†–∞—Å—á–µ—Ç—ã" –Ω–µ –Ω–∞–π–¥–µ–Ω.');
    return;
  }

  // –ü–æ–ª—É—á–∞–µ–º –º–µ—Å—è—Ü –∏ –≥–æ–¥
  var selectedMonth = String(getValue(calculationSheet, CellselectedMonth)).trim();
  var selectedYear = String(getValue(calculationSheet, CellSelectedYear)).trim();
  
  // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –º–µ—Å—è—Ü–∞ –≤ —á–∏—Å–ª–æ–≤–æ–π —Ñ–æ—Ä–º–∞—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–Ø–Ω–≤–∞—Ä—å" ‚Üí "01")
  var monthNumber = getMonthNumber(selectedMonth);

  // –§–æ—Ä–º–∏—Ä—É–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –ª–∏—Å—Ç–∞ "–õ–∏—á–Ω—ã–µ –ø—Ä–æ–¥–∞–∂–∏ –ú–ú.–ì–ì–ì–ì"
  var salesSheetName = '–õ–∏—á–Ω—ã–µ –ø—Ä–æ–¥–∞–∂–∏ ' + monthNumber + '.' + selectedYear;
  var salesSheet = ss.getSheetByName(salesSheetName);
  
  if (!salesSheet) {
    Logger.log('‚ùå –õ–∏—Å—Ç "' + salesSheetName + '" –Ω–µ –Ω–∞–π–¥–µ–Ω!');
    return;
  }
  
  Logger.log('üìå –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ –ª–∏—Å—Ç–∞: ' + salesSheetName);

  // –ü–æ–ª—É—á–∞–µ–º –∫–æ–º–∏—Å—Å–∏–∏ –∫–æ–ª–ª–µ–≥
  var nanaCell = findCellByValue(salesSheet, '–ù–∞—Ç–∞–ª—å—è –∫–æ–º–∏—Å—Å–∏—è –æ—Ç –∫–æ–ª–ª–µ–≥');
  var nanaCommission;
  if (nanaCell) {
    var nanaRow = nanaCell.getRow();
    var nanaCellAddress = nanaCell.getA1Notation();
    var nanaRawValue = salesSheet.getRange(nanaRow, 33).getValue(); // AG = 33-–π —Å—Ç–æ–ª–±–µ—Ü
    nanaCommission = parseFloat(nanaRawValue) || 0;
    Logger.log('üìå –ù–∞—Ç–∞–ª—å—è –∫–æ–º–∏—Å—Å–∏—è –æ—Ç –∫–æ–ª–ª–µ–≥: –Ω–∞–π–¥–µ–Ω–∞ —è—á–µ–π–∫–∞ %s (—Å—Ç—Ä–æ–∫–∞ %s)', nanaCellAddress, nanaRow);
    Logger.log('   - –ó–Ω–∞—á–µ–Ω–∏–µ –≤ AG (—Å—ã—Ä–æ–µ): %s', nanaRawValue);
    Logger.log('   - –ó–Ω–∞—á–µ–Ω–∏–µ –≤ AG (–ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–Ω–æ–µ): %s', nanaCommission);
  } else {
    nanaCommission = 0;
    Logger.log('‚ùå –ù–∞—Ç–∞–ª—å—è –∫–æ–º–∏—Å—Å–∏—è –æ—Ç –∫–æ–ª–ª–µ–≥: —è—á–µ–π–∫–∞ —Å —Ç–µ–∫—Å—Ç–æ–º –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
  }

  var sashaCell = findCellByValue(salesSheet, '–°–∞—à–∞ –∫–æ–º–º–∏—Å–∏—è –æ—Ç –∫–æ–ª–ª–µ–≥');
  var sashaCommission;
  if (sashaCell) {
    var sashaRow = sashaCell.getRow();
    var sashaCellAddress = sashaCell.getA1Notation();
    var sashaRawValue = salesSheet.getRange(sashaRow, 33).getValue(); // AG = 33-–π —Å—Ç–æ–ª–±–µ—Ü
    sashaCommission = parseFloat(sashaRawValue) || 0;
    Logger.log('üìå –°–∞—à–∞ –∫–æ–º–º–∏—Å–∏—è –æ—Ç –∫–æ–ª–ª–µ–≥: –Ω–∞–π–¥–µ–Ω–∞ —è—á–µ–π–∫–∞ %s (—Å—Ç—Ä–æ–∫–∞ %s)', sashaCellAddress, sashaRow);
    Logger.log('   - –ó–Ω–∞—á–µ–Ω–∏–µ –≤ AG (—Å—ã—Ä–æ–µ): %s', sashaRawValue);
    Logger.log('   - –ó–Ω–∞—á–µ–Ω–∏–µ –≤ AG (–ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–Ω–æ–µ): %s', sashaCommission);
  } else {
    sashaCommission = 0;
    Logger.log('‚ùå –°–∞—à–∞ –∫–æ–º–º–∏—Å–∏—è –æ—Ç –∫–æ–ª–ª–µ–≥: —è—á–µ–π–∫–∞ —Å —Ç–µ–∫—Å—Ç–æ–º –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
  }

  Logger.log('‚úÖ –ö–æ–º–∏—Å—Å–∏—è –∫–æ–ª–ª–µ–≥ (–ù–∞–Ω–∞): ' + nanaCommission + ' —Ä—É–±.');
  Logger.log('‚úÖ –ö–æ–º–∏—Å—Å–∏—è –∫–æ–ª–ª–µ–≥ (–°–∞—à–∞): ' + sashaCommission + ' —Ä—É–±.');

  // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ª–∏—Å—Ç "–ú–ï–°–Ø–¶ –ì–ì" (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–Ø–ù–í–ê–†–¨ 25")
  var monthUpperCase = selectedMonth.toUpperCase();
  var targetSheetName = monthUpperCase + ' ' + selectedYear.toString().slice(-2);
  var monthSheet = ss.getSheetByName(targetSheetName);
  
  if (!monthSheet) {
    Logger.log('‚ùå –õ–∏—Å—Ç –º–µ—Å—è—Ü–∞ "' + targetSheetName + '" –Ω–µ –Ω–∞–π–¥–µ–Ω!');
    return;
  }

  Logger.log('üìå –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –ª–∏—Å—Ç: ' + targetSheetName);

  // –ó–∞–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö –≤ —è—á–µ–π–∫–∏
  monthSheet.getRange('G31').setValue(nanaCommission);  // –ö–æ–º–∏—Å—Å–∏—è –∫–æ–ª–ª–µ–≥ (–ù–∞–Ω–∞)
  monthSheet.getRange('G19').setValue(sashaCommission); // –ö–æ–º–∏—Å—Å–∏—è –∫–æ–ª–ª–µ–≥ (–°–∞—à–∞)

  Logger.log('‚úÖ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–ø–∏—Å–∞–Ω—ã:');
  Logger.log('   - –ù–∞–Ω–∞ (–ö–æ–º–∏—Å—Å–∏—è): ' + nanaCommission + ' —Ä—É–±. -> G31');
  Logger.log('   - –°–∞—à–∞ (–ö–æ–º–∏—Å—Å–∏—è): ' + sashaCommission + ' —Ä—É–±. -> G19');
}


// –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –æ–±—â–µ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ —á–µ–∫–∞ –∑–∞ —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü
function calculateTotalAverageCheck() {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var calculationSheet = ss.getSheetByName('–†–∞—Å—á–µ—Ç—ã'); // –õ–∏—Å—Ç "–†–∞—Å—á–µ—Ç—ã"

  // –ü–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ —è—á–µ–µ–∫ H2 –∏ F2 –Ω–∞ –ª–∏—Å—Ç–µ "–†–∞—Å—á–µ—Ç—ã"
  var selectedMonth = getValue(calculationSheet, CellselectedMonth);
  var selectedYear = getValue(calculationSheet, CellSelectedYear);

  Logger.log('–°—Ä –∑–Ω–∞—á –í—ã–±—Ä–∞–Ω–Ω—ã–π –º–µ—Å—è—Ü: ' + selectedMonth);
  Logger.log('–°—Ä –∑–Ω–∞—á –í—ã–±—Ä–∞–Ω–Ω—ã–π –≥–æ–¥: ' + selectedYear);

  // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –º–µ—Å—è—Ü–∞ –≤ –µ–≥–æ —á–∏—Å–ª–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
  var monthNum = getMonthNumber(selectedMonth);
  var shortYear = selectedYear.toString().slice(-2); // –ü–æ—Å–ª–µ–¥–Ω–∏–µ –¥–≤–µ —Ü–∏—Ñ—Ä—ã –≥–æ–¥–∞

  // –§–æ—Ä–º–∏—Ä—É–µ–º –Ω–∞–∑–≤–∞–Ω–∏—è –ª–∏—Å—Ç–æ–≤
  var monthSheetName = `${selectedMonth.toUpperCase()} ${shortYear}`;
  var personalSalesSheetName = `–õ–∏—á–Ω—ã–µ –ø—Ä–æ–¥–∞–∂–∏ ${monthNum}.${selectedYear}`;

  Logger.log('–°—Ä –∑–Ω–∞—á –õ–∏—Å—Ç –º–µ—Å—è—Ü–∞: ' + monthSheetName);
  Logger.log('–°—Ä –∑–Ω–∞—á –õ–∏—Å—Ç –ª–∏—á–Ω—ã—Ö –ø—Ä–æ–¥–∞–∂: ' + personalSalesSheetName);

  var monthSheet = ss.getSheetByName(monthSheetName);
  var personalSalesSheet = ss.getSheetByName(personalSalesSheetName);

  if (!personalSalesSheet || !monthSheet) {
    if (!personalSalesSheet) {
      Logger.log('Sales sheet not found: ' + personalSalesSheetName);
    }
    if (!monthSheet) {
      Logger.log('Month sheet not found: ' + monthSheetName);
    }
    Logger.log('One or both sheets not found!');
    return;
  }

  // –®–∞–≥ 1: –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –æ–±—â–µ–π –≤—ã—Ä—É—á–∫–∏
  // var generalRevenueCell = findCellByValue(personalSalesSheet, '–í—ã—Ä—É—á–∫–∞ –æ–±—â–∞—è');
  var generalRevenueCell = findCellByValue(personalSalesSheet, '–í—ã—Ä—É—á–∫–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥');
  if (!generalRevenueCell) {
    Logger.log('General revenue cell not found!');
    return;
  }

  var generalRevenueRow = generalRevenueCell.getRow() + 1;
  var generalRevenue = personalSalesSheet.getRange(generalRevenueRow, generalRevenueCell.getColumn()).getValue();

  // –®–∞–≥ 2: –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è G49 –∏–∑ –ª–∏—Å—Ç–∞ "–ú–ï–°–Ø–¶ –ì–ì"
  var g49Value = monthSheet.getRange('AP49').getValue(); // –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–¥–∞–Ω–Ω—ã—Ö –∫–≤–∞—Ä—Ç–∏—Ä –∑–∞ –ø–µ—Ä–∏–æ–¥

  Logger.log(g49Value);

  if (g49Value == 0) {
    Logger.log('G49 value is zero, cannot divide by zero!');
    return;
  }

  // –®–∞–≥ 3: –†–∞—Å—á–µ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ —á–µ–∫–∞
  var averageCheck = generalRevenue / g49Value;
  Logger.log(generalRevenue);
  Logger.log(averageCheck);

  // –û–∫—Ä—É–≥–ª–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–≥–æ —á–µ–∫–∞ –¥–æ –±–ª–∏–∂–∞–π—à–µ–≥–æ —Ü–µ–ª–æ–≥–æ —á–∏—Å–ª–∞
  var roundedAverageCheck = Math.round(averageCheck);

  // –®–∞–≥ 4: –ó–∞–ø–∏—Å—å —Å—Ä–µ–¥–Ω–µ–≥–æ —á–µ–∫–∞ –Ω–∞ –ª–∏—Å—Ç–µ "–õ–∏—á–Ω—ã–µ –ø—Ä–æ–¥–∞–∂–∏ **.####"
  var averageCheckCell = findCellByValue(personalSalesSheet, '–°—Ä–µ–¥–Ω–∏–π —á–µ–∫ –æ–±—â–∏–π');
  if (!averageCheckCell) {
    Logger.log('Average check cell not found!');
    return;
  }

  var averageCheckRow = averageCheckCell.getRow() + 1;
  setValue(personalSalesSheet, 'A' + averageCheckRow, roundedAverageCheck);

  Logger.log('Average Check: ' + roundedAverageCheck);
  return roundedAverageCheck;
}



// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ–±—â–µ–π –≤—ã—Ä—É—á–∫–∏ –∏ –≤—ã—Ä—É—á–∫–∏ –∑–∞ –ø–µ—Ä–∏–æ–¥
function totalRevenue() {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var calculationSheet = ss.getSheetByName('–†–∞—Å—á–µ—Ç—ã'); // –õ–∏—Å—Ç "–†–∞—Å—á–µ—Ç—ã"
  Logger.log('Start function totalRevenue()');

  // –ü–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ —è—á–µ–µ–∫ H2 –∏ F2 –Ω–∞ –ª–∏—Å—Ç–µ "–†–∞—Å—á–µ—Ç—ã"
  var selectedMonth = getValue(calculationSheet, 'H2'); // –ó–∞–º–µ–Ω–∏—Ç–µ CellselectedMonth –Ω–∞ 'H2' –∏–ª–∏ –¥—Ä—É–≥—É—é –Ω—É–∂–Ω—É—é —è—á–µ–π–∫—É
  var selectedYear = getValue(calculationSheet, 'F2'); // –ó–∞–º–µ–Ω–∏—Ç–µ CellSelectedYear –Ω–∞ 'F2' –∏–ª–∏ –¥—Ä—É–≥—É—é –Ω—É–∂–Ω—É—é —è—á–µ–π–∫—É

  // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –º–µ—Å—è—Ü –≤ —á–∏—Å–ª–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –µ–≥–æ —Å –≤–µ–¥—É—â–∏–º –Ω—É–ª–µ–º
  var monthNum = getMonthNumber(selectedMonth); // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –º–µ—Å—è—Ü–∞ –≤ –µ–≥–æ —á–∏—Å–ª–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
  Logger.log('Month num: ' + monthNum);
  var shortYear = selectedYear.toString().slice(-2); // –ü–æ—Å–ª–µ–¥–Ω–∏–µ –¥–≤–µ —Ü–∏—Ñ—Ä—ã –≥–æ–¥–∞

  // –§–æ—Ä–º–∏—Ä—É–µ–º –Ω–∞–∑–≤–∞–Ω–∏—è –ª–∏—Å—Ç–æ–≤
  var monthSheetName = `${selectedMonth.toUpperCase()} ${shortYear}`;
  var personalSalesSheetName = `–õ–∏—á–Ω—ã–µ –ø—Ä–æ–¥–∞–∂–∏ ${monthNum}.${selectedYear}`;
  Logger.log('Name: ' + personalSalesSheetName);

  var monthSheet = ss.getSheetByName(monthSheetName);
  var personalSalesSheet = ss.getSheetByName(personalSalesSheetName);
  Logger.log('Sheet personal: ' + personalSalesSheet);

  // –®–∞–≥ 1: –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –æ–±—â–µ–π –≤—ã—Ä—É—á–∫–∏
  var generalRevenueCell = findCellByValue(personalSalesSheet, '–í—ã—Ä—É—á–∫–∞ –æ–±—â–∞—è');
  // var generalRevenueCell = findCellByValue(personalSalesSheet, '–í—ã—Ä—É—á–∫–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥');
  if (!generalRevenueCell) {
    Logger.log('General revenue cell not found!');
    return;
  }

  var generalRevenueRow = generalRevenueCell.getRow() + 1;
  var generalRevenue = personalSalesSheet.getRange(generalRevenueRow, generalRevenueCell.getColumn()).getValue();

  setValue(monthSheet, totalRevenueG, generalRevenue); // –õ–∏—Å—Ç –ú–ï–°–Ø–¶ –ì–ì, G145 –ù–∞—Å—Ç—Ä–æ–∏–ª –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é MS_TotalRevenue

  // –®–∞–≥ 2: –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è "–í—ã—Ä—É—á–∫–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥" –∏ –∑–∞–ø–∏—Å—å –µ–≥–æ –Ω–∞ –ª–∏—Å—Ç "–†–∞—Å—á–µ—Ç—ã" –≤ —è—á–µ–π–∫—É A48
  var periodRevenueCell = findCellByValueInColumn(personalSalesSheet, '–í—ã—Ä—É—á–∫–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥', 'A');
  Logger.log('–Ø—á–µ–π–∫–∞ –¥–ª—è –í—ã—Ä—É—á–∫–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥ ' + periodRevenueCell)
  if (periodRevenueCell) {
    var periodRevenueRow = periodRevenueCell.getRow() + 1;
    var periodRevenue = personalSalesSheet.getRange(periodRevenueRow, periodRevenueCell.getColumn()).getValue();
    setValue(calculationSheet, 'CALC_RevenuePeriod', periodRevenue);
    setValue(monthSheet, 'G14', periodRevenue)
    // setValue(calculationSheet, 'B101', periodRevenue);
    Logger.log('Period revenue: ' + periodRevenue);
  } else {
    Logger.log('Period revenue cell not found!');
  }
}


// –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–∏—Ö —á–µ–∫–æ–≤, –ø–æ–ª—É—á–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Ç–µ–∫—É—â–µ–≥–æ –∏ –ø—Ä–µ–¥ –º–µ—Å—è—Ü–∞
// –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–æ–ø —Ñ—É–Ω–∫—Ü–∏—è getWeeklyValues
function compareWeeklyAverages() {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var calculationSheet = ss.getSheetByName('–†–∞—Å—á–µ—Ç—ã');

  Logger.log('üìå –ó–∞–ø—É—Å–∫ compareWeeklyAverages');

  // –ü–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –º–µ—Å—è—Ü–∞ –∏ –≥–æ–¥–∞
  var selectedMonth = getValue(calculationSheet, 'H2');
  var selectedYear = getValue(calculationSheet, 'F2');

  Logger.log('üìå –í—ã–±—Ä–∞–Ω –º–µ—Å—è—Ü: ' + selectedMonth);
  Logger.log('üìå –í—ã–±—Ä–∞–Ω –≥–æ–¥: ' + selectedYear);

  // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –º–µ—Å—è—Ü –≤ —á–∏—Å–ª–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
  var monthNum = getMonthNumber(selectedMonth);
  var shortYear = selectedYear.toString().slice(-2);
  Logger.log('üìå –¢–µ–∫—É—â–∏–π –º–µ—Å—è—Ü: ' + monthNum + ', –ö–æ—Ä–æ—Ç–∫–∏–π –≥–æ–¥: ' + shortYear);

  // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø—Ä–æ—à–ª—ã–π –º–µ—Å—è—Ü –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –≥–æ–¥
  var previousMonthData = getPreviousMonth(selectedMonth, selectedYear);
  var previousMonth = previousMonthData.month;
  var previousYear = previousMonthData.year;
  var previousMonthNum = getMonthNumber(previousMonth);
  var previousShortYear = previousYear.toString().slice(-2);
  Logger.log('üìå –ü—Ä–æ—à–ª—ã–π –º–µ—Å—è—Ü: ' + previousMonth + ', –ì–æ–¥: ' + previousYear);
  Logger.log('üìå –ü—Ä–æ—à–ª—ã–π –º–µ—Å—è—Ü (—á–∏—Å–ª–æ): ' + previousMonthNum + ', –ö–æ—Ä–æ—Ç–∫–∏–π –≥–æ–¥: ' + previousShortYear);

  // –§–æ—Ä–º–∏—Ä—É–µ–º –Ω–∞–∑–≤–∞–Ω–∏—è –ª–∏—Å—Ç–æ–≤
  var personalSalesSheetName = `–õ–∏—á–Ω—ã–µ –ø—Ä–æ–¥–∞–∂–∏ ${monthNum}.${selectedYear}`;
  var previousPersonalSalesSheetName = `–õ–∏—á–Ω—ã–µ –ø—Ä–æ–¥–∞–∂–∏ ${previousMonthNum}.${previousYear}`;

  Logger.log('üìå –õ–∏—Å—Ç —Ç–µ–∫—É—â–µ–≥–æ –º–µ—Å—è—Ü–∞: ' + personalSalesSheetName);
  Logger.log('üìå –õ–∏—Å—Ç –ø—Ä–æ—à–ª–æ–≥–æ –º–µ—Å—è—Ü–∞: ' + previousPersonalSalesSheetName);

  var personalSalesSheet = ss.getSheetByName(personalSalesSheetName);
  var previousPersonalSalesSheet = ss.getSheetByName(previousPersonalSalesSheetName);

  // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –ª–∏—Å—Ç–æ–≤
  if (!personalSalesSheet) {
    Logger.log('‚ùå –õ–∏—Å—Ç –ª–∏—á–Ω—ã—Ö –ø—Ä–æ–¥–∞–∂ –Ω–µ –Ω–∞–π–¥–µ–Ω: ' + personalSalesSheetName);
    return;
  }
  if (!previousPersonalSalesSheet) {
    Logger.log('‚ùå –õ–∏—Å—Ç –ª–∏—á–Ω—ã—Ö –ø—Ä–æ–¥–∞–∂ –ø—Ä–æ—à–ª–æ–≥–æ –º–µ—Å—è—Ü–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω: ' + previousPersonalSalesSheetName);
    return;
  }

  Logger.log('‚úÖ –û–±–∞ –ª–∏—Å—Ç–∞ –Ω–∞–π–¥–µ–Ω—ã, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ.');

  // –ü–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –Ω–µ–¥–µ–ª—å –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –∏ –ø—Ä–æ—à–ª–æ–≥–æ –º–µ—Å—è—Ü–∞
  var currentWeeklyValues = getWeeklyValues(personalSalesSheet);
  var previousWeeklyValues = getWeeklyValues(previousPersonalSalesSheet);

  // –ó–∞–ø–∏—Å—å –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –º–µ—Å—è—Ü–∞
  calculationSheet.getRange('M40').setValue(selectedMonth);
  calculationSheet.getRange('N40').setValue(previousMonth);

  for (var i = 0; i < 4; i++) {
    calculationSheet.getRange(41 + i, 12).setValue((i + 1) + ' –Ω–µ–¥–µ–ª—è'); // L41 - L44
    calculationSheet.getRange(41 + i, 13).setValue(currentWeeklyValues[i]); // M41 - M44
    calculationSheet.getRange(41 + i, 14).setValue(previousWeeklyValues[i]); // N41 - N44
  }


  Logger.log('üìå –ó–Ω–∞—á–µ–Ω–∏—è –Ω–µ–¥–µ–ª—å –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –º–µ—Å—è—Ü–∞: ' + JSON.stringify(currentWeeklyValues));
  Logger.log('üìå –ó–Ω–∞—á–µ–Ω–∏—è –Ω–µ–¥–µ–ª—å –¥–ª—è –ø—Ä–æ—à–ª–æ–≥–æ –º–µ—Å—è—Ü–∞: ' + JSON.stringify(previousWeeklyValues));
}



// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–µ –æ–±—â–µ–π –≤—ã—Ä—É—á–∫–∏ –∑–∞ –ø—Ä–æ—à–ª—ã–π –ø–µ—Ä–∏–æ–¥
function totalRevenueLastMonth() {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var calculationSheet = ss.getSheetByName('–†–∞—Å—á–µ—Ç—ã'); // –õ–∏—Å—Ç "–†–∞—Å—á–µ—Ç—ã"
  Logger.log('Start function totalRevenueLastMonth()');

  // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü –∏ –≥–æ–¥
  var selectedMonth = getValue(calculationSheet, 'H2');
  var selectedYear = getValue(calculationSheet, 'F2');

  // –í—ã—á–∏—Å–ª—è–µ–º –ø—Ä–æ—à–ª—ã–π –º–µ—Å—è—Ü –∏ –≥–æ–¥
  var lastMonthDate = new Date(selectedYear, getMonthNumber(selectedMonth) - 2, 1);
  var lastMonthName = convertMonthToUpperCase(getMonthNameFromDate(lastMonthDate));
  var lastYear = lastMonthDate.getFullYear();
  var shortLastYear = lastYear.toString().slice(-2);

  // –§–æ—Ä–º–∏—Ä—É–µ–º –Ω–∞–∑–≤–∞–Ω–∏—è –ª–∏—Å—Ç–æ–≤
  var lastMonthSheetName = `${lastMonthName} ${shortLastYear}`;
  var personalSalesSheetName = `–õ–∏—á–Ω—ã–µ –ø—Ä–æ–¥–∞–∂–∏ ${getMonthNumber(lastMonthName)}.${lastYear}`;

  var lastMonthSheet = ss.getSheetByName(lastMonthSheetName);
  var personalSalesSheet = ss.getSheetByName(personalSalesSheetName);

  if (!lastMonthSheet) {
    Logger.log(`‚ùå –õ–∏—Å—Ç –ø—Ä–æ—à–ª–æ–≥–æ –º–µ—Å—è—Ü–∞ "${lastMonthSheetName}" –Ω–µ –Ω–∞–π–¥–µ–Ω!`);
    return;
  }
  if (!personalSalesSheet) {
    Logger.log(`‚ùå –õ–∏—Å—Ç –ª–∏—á–Ω—ã—Ö –ø—Ä–æ–¥–∞–∂ –ø—Ä–æ—à–ª–æ–≥–æ –º–µ—Å—è—Ü–∞ "${personalSalesSheetName}" –Ω–µ –Ω–∞–π–¥–µ–Ω!`);
    return;
  }

  // –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –æ–±—â–µ–π –≤—ã—Ä—É—á–∫–∏
  var generalRevenueCell = findCellByValue(personalSalesSheet, '–í—ã—Ä—É—á–∫–∞ –æ–±—â–∞—è');
  if (!generalRevenueCell) {
    Logger.log('‚ùå "–í—ã—Ä—É—á–∫–∞ –æ–±—â–∞—è" –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –Ω–∞ –ª–∏—Å—Ç–µ –ª–∏—á–Ω—ã—Ö –ø—Ä–æ–¥–∞–∂ –ø—Ä–æ—à–ª–æ–≥–æ –º–µ—Å—è—Ü–∞!');
    return;
  }

  var generalRevenueRow = generalRevenueCell.getRow() + 1;
  var generalRevenue = personalSalesSheet.getRange(generalRevenueRow, generalRevenueCell.getColumn()).getValue();

  // –í—Å—Ç–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ —è—á–µ–π–∫—É –ø—Ä–æ—à–ª–æ–≥–æ –º–µ—Å—è—Ü–∞
  setValue(lastMonthSheet, totalRevenueG, generalRevenue);
  Logger.log(`‚úÖ –î–∞–Ω–Ω—ã–µ (${generalRevenue}) —É—Å–ø–µ—à–Ω–æ –∑–∞–ø–∏—Å–∞–Ω—ã –≤ "${lastMonthSheetName}" -> G145`);

  // –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è "–í—ã—Ä—É—á–∫–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥"
  var periodRevenueCell = findCellByValue(personalSalesSheet, '–í—ã—Ä—É—á–∫–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥');
  if (!periodRevenueCell) {
    Logger.log('‚ùå "–í—ã—Ä—É—á–∫–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥" –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –Ω–∞ –ª–∏—Å—Ç–µ –ª–∏—á–Ω—ã—Ö –ø—Ä–æ–¥–∞–∂ –ø—Ä–æ—à–ª–æ–≥–æ –º–µ—Å—è—Ü–∞!');
    return;
  }

  var periodRevenueRow = periodRevenueCell.getRow() + 1;
  var periodRevenue = personalSalesSheet.getRange(periodRevenueRow, periodRevenueCell.getColumn()).getValue();

  // –í—Å—Ç–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ —è—á–µ–π–∫—É A49 –Ω–∞ –ª–∏—Å—Ç–µ "–†–∞—Å—á–µ—Ç—ã"
  setValue(calculationSheet, 'CALC_RevenuePeriodLastPeriod', periodRevenue);
  // setValue(calculationSheet, 'C101', periodRevenue);
  Logger.log(`‚úÖ –î–∞–Ω–Ω—ã–µ (${periodRevenue}) —É—Å–ø–µ—à–Ω–æ –∑–∞–ø–∏—Å–∞–Ω—ã –≤ "–†–∞—Å—á–µ—Ç—ã" -> A49`);
}